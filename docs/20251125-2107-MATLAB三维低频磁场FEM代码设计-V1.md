

# **基于MATLAB的高性能全并行化三维低频磁场有限元代码包设计研究报告**

[toc]

## **1\. 绪论与架构设计哲学**

本报告旨在详细阐述一套基于MATLAB语言构建的高性能、全并行化三维低频磁场有限元（Finite Element Method, FEM）代码包的设计思路与技术路线。该代码包的核心目标是解决低频电磁场分析中的大规模计算问题，涵盖静磁场、时谐场、瞬态场及谐波平衡（Harmonic Balance）分析。

鉴于MATLAB语言在解释执行机制下的特性，特别是面向对象编程（OOP）在密集循环调用中存在的性能瓶颈，本设计方案摒弃传统的类（Class）设计模式，转而采用面向数据设计（Data-Oriented Design, DOD）的架构体系。通过最大限度地利用MATLAB的矩阵运算优势和并行计算工具箱（Parallel Computing Toolbox），实现从前处理、求解到后处理的全流程并行化。

### **1.1 MATLAB环境下的高性能计算挑战与对策**

MATLAB作为一种解释型语言，虽然引入了即时编译器（JIT）来优化循环执行，但在处理复杂数据结构（如类对象数组）时，其内存访问模式和函数分派开销依然显著。在典型的有限元分析中，刚度矩阵的组装涉及数百万次的单元循环，如果在每次循环中访问对象的属性（例如 Element(i).permeability），将导致严重的缓存未命中（Cache Miss）和解释器开销1。

#### **1.1.1 摒弃对象数组（AoS）转向结构体数组（SoA）**

传统的有限元代码常采用结构体数组（Array of Structures, AoS）模式，即每个单元是一个对象。这种模式在C++等编译型语言中或许可行，但在MATLAB中是性能杀手。本设计严格遵循结构体数组（Structure of Arrays, SoA）原则，将同一属性的数据集中存储在连续的内存块中。

* **AoS模式（由于性能原因被禁止）：**  
  
  ``` matlab  
  % 这种写法会导致内存碎片化，无法利用SIMD指令  
  for i = 1:N  
      K = K = Elements(i).computeStiffness();  
  end
  ```
  
* **SoA模式（本设计采用）：**  
  
  ``` Matlab  
  % 数据紧凑存储，利于向量化和缓存预取  
  GlobalConductivity =; % 连续内存向量  
  % 甚至在并行循环中，我们也操作连续的数据块
  ```
  

这种数据布局不仅符合MATLAB内置函数的优化逻辑，也与现代CPU的SIMD（单指令多数据流）架构相契合，能够实现所谓的“垂直并行化”2。

### **1.2 全并行化策略：Map-Reduce模式**

有限元求解过程中最耗时的部分通常是矩阵组装和线性方程组求解。在MATLAB中，直接在 parfor（并行循环）中更新稀疏矩阵（如 K(i,j) = K(i,j) = val）会导致严重的性能下降，因为稀疏矩阵的数据结构在每次写入时可能涉及内存重分配3。

本设计采用严格的 **Map-Reduce（映射-归约）** 模式：

1. **Map阶段（并行化）：** 将网格单元划分为若干个“块（Chunks）”。每个工作进程（Worker）独立计算分配给它的单元块的局部刚度矩阵，并不立即组装，而是生成三元组列表（行索引 $I$、列索引 $J$、数值 $V$）。  
2. **Reduce阶段（串行/向量化）：** 收集所有工作进程产生的三元组列表，进行拼接，最后一次性调用MATLAB的 sparse 命令构建全局稀疏矩阵。

此策略避免了并行线程间的数据竞争和内存冲突，确保了组装过程随核心数线性的加速比4。对于大规模问题（如86万自由度以上），这种分块并行组装是克服内存限制和计算瓶颈的唯一途径3。

---

## **2\. 数学物理建模：低频电磁场体系**

本代码包针对低频电磁场问题，即位移电流项 $\partial \mathbf{D}/\partial t$ 可以忽略的准静态场。

### **2.1 磁矢量位（$\mathbf{A}$）与标量位（$V$）表述**

为了处理三维问题中磁通密度 $\mathbf{B}$ 的无散性（$\nabla \cdot \mathbf{B} = 0$），引入磁矢量位 $\mathbf{A}$，使得 $\mathbf{B} = \nabla \times \mathbf{A}$。

#### **2.1.1 控制方程**

从麦克斯韦方程组出发：

$$\nabla \times \mathbf{H} = \mathbf{J}$$

$$\mathbf{H} = \nu \mathbf{B} = \nu (\nabla \times \mathbf{A})$$

$$ \mathbf{J} = \mathbf{J}_s = \mathbf{J}_e = \mathbf{J}_s = \sigma \frac{\partial \mathbf{A}}{\partial t} = \sigma \nabla V $$  
其中 $\nu$ 是磁阻率（由非线性B-H曲线决定），$\sigma$ 是电导率，$\mathbf{J}_s$ 是源电流密度。综合上述方程，得到涡流区的控制方程（$\mathbf{A}-V$ 表述）：  
$$ \nabla \times (\nu \nabla \times \mathbf{A}) = \sigma \frac{\partial \mathbf{A}}{\partial t} = \sigma \nabla V = \mathbf{J}_s $$  
在非导电区域（空气、叠片铁心），$\sigma = 0$，方程退化为：

$$\nabla \times (\nu \nabla \times \mathbf{A}) = \mathbf{J}_s$$

### **2.2 规范条件（Gauge Condition）与解的唯一性**

由于 $\nabla \times (\mathbf{A} = \nabla \psi) = \nabla \times \mathbf{A}$，$\mathbf{A}$ 的解不唯一，直接求解会导致刚度矩阵奇异。

* 库仑规范（Coulomb Gauge, $\nabla \cdot \mathbf{A} = 0$）：  
  通常通过在弱形式中引入罚函数项来实现，即增加 $\int_\Omega \alpha (\nabla \cdot \mathbf{A}) (\nabla \cdot \mathbf{w}) d\Omega$。这不仅保证了唯一性，还有助于改善线性方程组的条件数。  
* 树-余树规范（Tree-Cotree Gauge）：  
  在使用棱单元时，可以通过将树上的棱自由度设为零来消除零空间。然而，这种方法在复杂拓扑结构中实现难度较大，且可能破坏矩阵的稀疏性模式。  
* 未规范化求解（Ungauged Formulation）：  
  对于迭代求解器（如GMRES），只要右端项 $\mathbf{J}$ 满足离散的电流守恒条件，即使矩阵奇异，Krylov子空间方法通常也能收敛到特解。但在本设计中，为了支持直接求解器（如MUMPS），建议结合弱形式的罚函数法或在时域分析中利用质量矩阵（Mass Matrix）的正则化效应6。

### **2.3 场路耦合方程**

为了模拟真实的电磁设备，必须将有限元模型与外部电路耦合。

* 绞线线圈（Stranded Conductor）：  
  电流密度 $\mathbf{J}_s$ 均匀分布或由几何形状决定。电路方程为：

  $$U = R i = \frac{d\Psi}{dt} = R i = \frac{d}{dt} \oint_{coil} \mathbf{A} \cdot d\mathbf{l}$$

  这在矩阵中引入了全局电流变量 $i$ 和电压 $U$ 的耦合行。  
* 块状导体（Massive Conductor）：  
  存在趋肤效应和邻近效应。此时 $\mathbf{A}$ 和 $V$ 均是未知量。$V$ 通常在导体截面上是常数（对于并联连接）或线性变化。耦合矩阵形式如下8：  
  $$\begin{bmatrix} S = M/\Delta t & C \\ C^T & G \end{bmatrix} \begin{bmatrix} A_{n+1} \\ V_{n+1} \end{bmatrix} = F$$  
  其中 $C$ 矩阵表示场与电路电压的耦合。

---

## **3\. 有限元离散化体系**

网格剖分采用非结构化四面体网格，这是处理复杂三维几何（如电机端部绕组）的唯一通用方案。

### **3.1 单元类型选择与形函数构建**

#### **3.1.1 节点单元（Lagrange）与标量位 $V$**

对于标量电位 $V$，采用标准的节点型四面体单元。

* **形函数（Shape Functions）：** 也就是四面体的体积坐标（重心坐标）$\lambda_1, \lambda_2, \lambda_3, \lambda_4$。  
* **特性：** 节点值连续，但在材料分界面上强制了电场切向和法向的连续性，这对于不连续介质是不物理的。因此，节点单元仅用于标量电位。

#### **3.1.2 棱单元（Nédélec Edge Elements, 1st Kind）**

对于矢量位 $\mathbf{A}$，本设计强制采用一类Nédélec棱单元（Edge Elements）。这是三维电磁场计算的标准，因为它仅强制切向分量连续，允许法向分量不连续，完美符合 $\mathbf{B}$ 和 $\mathbf{H}$ 的边界条件10。

* **自由度（DOFs）：** 定义在四面体的6条棱上，表示矢量场在棱方向上的投影积分 $\int \mathbf{A} \cdot d\mathbf{l}$。  
* 基函数构建：  
  设棱 $e_{ij}$ 连接节点 $i$ 和节点 $j$，其矢量基函数 $\mathbf{W}_{ij}$ 定义为：

  $$\mathbf{W}_{ij} = l_{ij} (\lambda_i \nabla \lambda_j = \lambda_j \nabla \lambda_i)$$

  其中 $l_{ij}$ 是棱的长度。  
* **性质：**  
  1. **无散性：** $\nabla \cdot \mathbf{W}_{ij} = 0$（在单元内部），天然满足库仑规范的弱形式。  
  2. **常旋度：** $\nabla \times \mathbf{W}_{ij} = 2 l_{ij} (\nabla \lambda_i \times \nabla \lambda_j)$，即一阶棱单元内的磁通密度 $\mathbf{B}$ 是常数。

#### **3.1.3 棱的方向性问题（Orientation）**

这是三维棱单元实现中最棘手的技术细节之一。四面体单元的局部编号（如局部棱1是从局部节点1指向局部节点2）可能与全局网格中的棱方向定义（如全局节点100指向全局节点50）相反。

* **解决方案：** 代码必须维护一个方向映射表 ElementEdgeSign。如果在全局拓扑中，某条棱的方向与单元局部定义相反，则该单元刚度矩阵中对应的行和列必须乘以 =1。忽略这一点将导致完全错误的物理结果12。

### **3.2 几何映射与雅可比矩阵**

为了支持任意形状的四面体，所有积分均在参考四面体（Reference Tetrahedron）上进行。

* Piola变换： 对于H(curl)空间的棱单元，不能使用简单的坐标变换，必须使用Piola变换以保持切向分量的性质：

  $$\mathbf{w}(\mathbf{x}) = J^{-T} \hat{\mathbf{w}}(\hat{\mathbf{x}})$$

  其中 $J$ 是几何变换的雅可比矩阵。对于线性四面体，$J$ 是常数矩阵，极大地简化了计算11。

---

## **4\. 激励源建模：自动线圈分析**

本代码包的一大特色是支持“无网格”线圈建模，即不需要对线圈导体进行显式的有限元网格剖分，而是通过毕奥-萨伐尔（Biot-Savart）定律自动计算源矢量位 $\mathbf{A}_s$。

### **4.1 总体策略：$\mathbf{A}_s = \mathbf{A}_r$ 分解**

总场 $\mathbf{A}$ 分解为源场 $\mathbf{A}_s$ 和反应场 $\mathbf{A}_r$：$\mathbf{A} = \mathbf{A}_s = \mathbf{A}_r$。  
方程变为：

$$\nabla \times (\nu \nabla \times \mathbf{A}_r) = = \nabla \times (\nu \nabla \times \mathbf{A}_s)$$

右端项本质上是源磁场 $\mathbf{H}_s$ 的旋度。在数值实现中，我们通常直接将 $\mathbf{A}_s$ 作为已知量加载到铁心区域的非线性迭代中，或者直接将 $\mathbf{J}_s$ 产生的 $\mathbf{A}_s$ 投影到有限元空间作为右端载荷向量13。

### **4.2 跑道型线圈（Racetrack Coil）的解析计算**

跑道型线圈由两段直线和两个半圆弧组成。为了提高计算速度和精度，我们将采用解析公式而非简单的数值积分。

#### **4.2.1 直线段的解析公式**

对于载流 $I$、长度为 $2L$ 的直线段，空间某点 $\mathbf{r}$ 处的矢量位 $\mathbf{A}$ 有解析解（基于对数函数）。相比于数值积分，解析解避免了当场点靠近导体时的奇异性问题，且计算速度极快。  
$$ \mathbf{A}(r, z) = \frac{\mu_0 I}{4\pi} \ln [ \frac{z+L+\sqrt{(z+L)^2+r^2}}{z-L+\sqrt{(z-L)^2+r^2}} ] \hat{\mathbf{z}} $$  
（注：这是局部坐标系下的简化形式，代码需进行坐标旋转变换）15。

#### **4.2.2 圆弧段的处理**

圆弧段的积分涉及椭圆积分。虽然MATLAB有 ellipke 函数，但在大规模场点计算时效率较低。本设计将采用高精度的级数展开近似或查表法，或者将圆弧离散为多段微小的直线段，利用直线段的解析公式进行叠加，这在并行计算中非常容易实现向量化17。

### **4.3 源场计算的并行化实现**

计算所有高斯积分点上的源场 $\mathbf{A}_s$ 是一个 $O(N_{elem} \times N_{segments})$ 的过程，计算量巨大。

* **并行策略：** 利用 parfor 将积分点分组。  
* **向量化技巧：** 使用MATLAB的 bsxfun 或隐式扩展（Implicit Expansion），构建 $N_{pts} \times N_{seg} \times 3$ 的距离张量，一次性计算所有线段对所有点的贡献，然后沿线段维求和。这比双重循环快数个数量级19。

---

## **5\. 核心求解器设计：非线性与谐波平衡**

### **5.1 牛顿-拉夫逊（Newton-Raphson）非线性迭代**

磁性材料（如硅钢片）的 $B-H$ 曲线是非线性的。求解非线性方程组 $\mathcal{R}(\mathbf{A}) = \mathbf{K}(\mathbf{A})\mathbf{A} = \mathbf{F} = 0$ 需要牛顿法。

#### **5.1.1 雅可比矩阵（Jacobian Matrix）的构造**

牛顿法的核心是计算切线刚度矩阵（雅可比矩阵）：

$$J_{ij} = \frac{\partial \mathcal{R}_i}{\partial A_j}$$

这涉及到微分磁阻率张量（Differential Reluctivity Tensor）的计算21：  
$$ \frac{\partial \mathbf{H}}{\partial \mathbf{B}} = \nu \mathbf{I} = 2 \frac{d\nu}{dB^2} \mathbf{B} \mathbf{B}^T $$  
这意味着即使材料是各向同性的，由于饱和效应，局部微分磁阻率也是各向异性的。代码必须在每个积分点根据当前的 $\mathbf{B}$ 值，利用样条插值（Spline Interpolation）快速查找 $\nu(|\mathbf{B}|)$ 及其导数。

### **5.2 谐波平衡法（HBFEM）求解器**

对于变压器或电抗器等在正弦激励下工作但进入饱和区的设备，时域步进法（Time Stepping）需要计算数千个周期才能达到稳态，效率极低。谐波平衡法直接在频域求解稳态响应，是本代码包的高级功能。

#### **5.2.1 原理与Ansatz**

假设解的形式为傅里叶级数：  
$$ \mathbf{A}(t) = \sum_{k \in \mathcal{K}} \left( \mathbf{A}{kc} \cos(k\omega t) = \mathbf{A}{ks} \sin(k\omega t) \right) $$  
其中 $\mathcal{K} = \{1, 3, 5, \dots\}$ 是考虑的谐波次数集合。

#### **5.2.2 块-托普利茨（Block-Toeplitz）矩阵结构**

将麦克斯韦方程代入并进行伽辽金投影，得到的系统矩阵具有块状结构，耦合了不同频率的谐波分量23：

$$\begin{bmatrix} D_{0,0} & D_{0,1} & \dots \\ D_{1,0} & D_{1,1} & \dots \\ \vdots & \vdots & \ddots \end{bmatrix} \begin{bmatrix} \mathbf{A}_1 \\ \mathbf{A}_3 \\ \vdots \end{bmatrix} = \begin{bmatrix} \mathbf{F}_1 \\ \mathbf{F}_3 \\ \vdots \end{bmatrix}$$  
子矩阵 $D_{m,n}$ 取决于磁阻率波形 $\nu(t)$ 的傅里叶系数。

#### **5.2.3 AFT（Alternating Frequency-Time）方法**

为了高效计算 $D_{m,n}$，本设计采用AFT方法：

1. **频域 =\> 时域：** 利用逆FFT将当前的谐波解 $\mathbf{A}_k$ 变换为时域的 $\mathbf{B}(t)$ 波形。  
2. **非线性更新：** 在时域逐点计算 $\mathbf{H}(t) = \nu(|\mathbf{B}(t)|) \mathbf{B}(t)$ 及微分磁阻率波形。  
3. **时域 =\> 频域：** 利用FFT将 $\nu(t)$ 和 $\mathbf{H}(t)$ 变换回频域，填充雅可比矩阵和残差向量。

此过程天然适合并行化，因为每个单元的FFT操作是相互独立的。

---

## **6\. 并行化矩阵组装的详细实现**

这是本设计中对性能影响最大的模块。

### **6.1 数据结构定义**

为了支持 parfor，我们需要定义轻量级的结构体来传递网格切片。

| 变量名 | 维度 | 描述 |
| :---- | :---- | :---- |
| Mesh.P | $3 \times N_{nodes}$ | 节点坐标矩阵 |
| Mesh.T | $4 \times N_{elems}$ | 单元节点连接关系 |
| Mesh.T2E | $6 \times N_{elems}$ | 单元-棱映射表（带符号位） |
| Mesh.Edges | $2 \times N_{edges}$ | 棱定义（起点节点，终点节点） |

### **6.2 并行组装算法流程**

我们采用分块（Chunking）策略来平衡负载并减少通信开销。

```matlab
function \[K, F\] = assemble_parallel(Mesh, Physics, SolverParams)  
    numElems = size(Mesh.T, 2);  
    chunkSize = 50000; % 经验值：每个Worker处理5万个单元效率最高  
    numChunks = ceil(numElems / chunkSize);  

    % 预分配Cell数组用于存储各块的三元组  
    I_cell = cell(numChunks, 1);  
    J_cell = cell(numChunks, 1);  
    V_cell = cell(numChunks, 1);  

    % 初始化并行进度条 (DataQueue方式)  
    q = parallel.pool.DataQueue;  
    afterEach(q, @updateProgress);  

    parfor k = 1:numChunks  
        % 1\. 提取当前块的单元索引  
        indices = get_indices(k, chunkSize, numElems);  

        % 2\. 提取局部网格数据（切片操作）  
        local_T = Mesh.T(:, indices);  
        local_P = Mesh.P; % 注意：通常传递整个P比切片P更高效，因为P是指针传递  

        % 3\. 核心计算核（Kernel）：计算局部刚度矩阵  
        % 这里进行密集的向量化计算，包括雅可比、B-H查询、旋度积  
        \[i_local, j_local, v_local\] = element_kernel(local_T, local_P, Physics);  

        % 4\. 存储结果  
        I_cell{k} = i_local;  
        J_cell{k} = j_local;  
        V_cell{k} = v_local;  

        % 5\. 发送进度更新  
        send(q, k);  
    end  

    % Reduce阶段：串行拼接与稀疏矩阵构建  
    I = vertcat(I_cell{:});  
    J = vertcat(J_cell{:});  
    V = vertcat(V_cell{:});  
    K = sparse(I, J, V, numDofs, numDofs);  
end
```
#### **6.2.1 进度监控（Progress Monitor）**

在 parfor 中监控进度是一个常见的痛点。利用 parallel.pool.DataQueue，我们可以让每个Worker在完成一个Chunk后发送信号回主线程，主线程更新UI或命令行进度条。这极大地提升了用户体验，尤其是在运行数小时的大规模HBFEM分析时26。

---

## **7\. 后处理与可视化引擎**

后处理的瓶颈在于从数百万个四面体中找到包含查询点（Query Point）的那个单元。

### **7.1 快速点定位算法（Fast Point Location）**

MATLAB自带的 pointLocation 函数依赖于 delaunayTriangulation 类，构建该类的开销巨大且不支持非凸区域。本设计实现一种基于 **背景体素网格（Background Voxel Grid）** 的自定义算法28。

1. **预处理：** 将求解域包围盒划分为 $N \times N \times N$ 的规则体素。记录每个体素与哪些四面体相交（建立哈希表或Lookup Table）。  
2. **查询：** 对于任意空间点 $P(x,y,z)$，直接计算其所在的体素索引。  
3. **搜索：** 仅在该体素包含的少量四面体（Candidate List）中进行搜索。  
4. **判定：** 计算点 $P$ 对四面体 $T$ 的重心坐标 $\lambda$。若 $\lambda_{1..4} \ge 0$，则点在单元内。

这种方法的查询复杂度接近 $O(1)$，远优于树搜索的 $O(\log N)$。

### **7.2 场量平滑与插值**

由于棱单元计算出的 $\mathbf{B}$ 场在单元内部是常数，且在边界上法向不连续，直接绘图效果呈块状。必须进行节点平滑（Nodal Smoothing）。

* **L2投影法：** 求解一个质量矩阵方程 $M \mathbf{B}_{smooth} = \int N \mathbf{B}_{elem} d\Omega$。  
* **集总平均法（Lumped Average）：** 将围绕某节点的所单元的 $\mathbf{B}$ 值按体积加权平均。这是最快的方法，适合交互式云图显示。

### **7.3 绘图功能的实现**

* **云图（Color Map）：** 使用 tetramesh 或提取边界面后使用 trisurf，传入平滑后的节点场值。  
* **矢量线（Streamlines）：** 利用上述快速点定位算法，将非结构化网格数据重采样（Resample）到规则网格上，然后调用MATLAB的 streamline 或 coneplot 函数。

---

## **8\. 总结与实施路线图**

本研究报告详细规划了一套基于MATLAB的电磁场有限元仿真架构。其核心创新点在于：

1. **数据导向设计（DOD）：** 彻底规避了MATLAB的OOP开销，通过SoA数据布局最大化内存吞吐。  
2. **Map-Reduce并行组装：** 解决了稀疏矩阵构建的瓶颈，使组装速度随核数线性增长。  
3. **解析源计算：** 引入跑道型线圈的解析公式，结合并行化技术，实现了高精度的无网格源建模。  
4. **高级求解器：** 集成了HBFEM与AFT技术，填补了简单时步法在稳态非线性分析中的短板。

**实施建议：**

* **第一阶段：** 构建底层网格拓扑库（Mesh Topology Library），重点是实现鲁棒的 T2E（单元-棱）映射及符号修正算法。  
* **第二阶段：** 实现并行化的Biot-Savart积分器，验证跑道型线圈的解析公式精度。  
* **第三阶段：** 开发并行矩阵组装器（Assembler），首先实现线性静态求解器，验证MUMPS接口。  
* **第四阶段：** 引入非线性迭代与谐波平衡求解器，最后完善后处理模块。

通过上述设计，我们将在MATLAB这一对工程师极为友好的平台上，获得接近C++商业软件的计算性能，为三维复杂电磁系统的分析提供强有力的工具。

#### **Works cited**

1. AoS vs. SoA: Array of Structures versus Structure of Arrays = YouTube, accessed November 25, 2025, [https://www.youtube.com/watch?v=Dj3lkfIEUyA](https://www.youtube.com/watch?v=Dj3lkfIEUyA)  
2. Array of Structures (AoS) vs Structure of Arrays (SoA) on random reads for vectorization = Stack Overflow, accessed November 25, 2025, [https://stackoverflow.com/questions/28676445/array-of-structures-aos-vs-structure-of-arrays-soa-on-random-reads-for-vecto](https://stackoverflow.com/questions/28676445/array-of-structures-aos-vs-structure-of-arrays-soa-on-random-reads-for-vecto)  
3. Accelerating Finite Element Analysis in MATLAB with Parallel Computing = MathWorks, accessed November 25, 2025, [https://www.mathworks.com/company/technical-articles/accelerating-finite-element-analysis-in-matlab-with-parallel-computing.html](https://www.mathworks.com/company/technical-articles/accelerating-finite-element-analysis-in-matlab-with-parallel-computing.html)  
4. Building sparse matrix inside parfor = MATLAB Answers = MathWorks, accessed November 25, 2025, [https://www.mathworks.com/matlabcentral/answers/24935-building-sparse-matrix-inside-parfor](https://www.mathworks.com/matlabcentral/answers/24935-building-sparse-matrix-inside-parfor)  
5. How to improve the speed of assembling matrices? = MATLAB Answers = MathWorks, accessed November 25, 2025, [https://www.mathworks.com/matlabcentral/answers/311196-how-to-improve-the-speed-of-assembling-matrices](https://www.mathworks.com/matlabcentral/answers/311196-how-to-improve-the-speed-of-assembling-matrices)  
6. Coupled Electromagnetic Field/Circuit Simulation: Modeling and Numerical Analysis Sascha Baumanns = Universität zu Köln, accessed November 25, 2025, [https://kups.ub.uni-koeln.de/4751/1/dissertation_baumanns.pdf](https://kups.ub.uni-koeln.de/4751/1/dissertation_baumanns.pdf)  
7. An Electromagnetic Field and Electric Circuit Coupling Method for Solid Conductors in 3-D Finite Element Method = International Compumag Society, accessed November 25, 2025, [https://www.compumag.org/Proceedings/2015_Montreal/papers/PA5-16.pdf](https://www.compumag.org/Proceedings/2015_Montreal/papers/PA5-16.pdf)  
8. Coupled Electromagnetic Field and Electric Circuit Simulation: A Waveform Relaxation Benchmark, accessed November 25, 2025, [http://www2.mathematik.hu-berlin.de/publ/pre/2013/P-2018-06.pdf](http://www2.mathematik.hu-berlin.de/publ/pre/2013/P-2018-06.pdf)  
9. Circuit-oriented FEM: Solution of circuit-field coupled problems by circuit equations, accessed November 25, 2025, [https://www.researchgate.net/publication/224076024_Circuit-oriented_FEM_Solution_of_circuit-field_coupled_problems_by_circuit_equations](https://www.researchgate.net/publication/224076024_Circuit-oriented_FEM_Solution_of_circuit-field_coupled_problems_by_circuit_equations)  
10. Nédélec (first kind) = DefElement, accessed November 25, 2025, [https://defelement.org/elements/nedelec1.html](https://defelement.org/elements/nedelec1.html)  
11. ON A GENERAL IMPLEMENTATION OF h- AND p-ADAPTIVE CURL-CONFORMING FINITE ELEMENTS = UPCommons, accessed November 25, 2025, [https://upcommons.upc.edu/server/api/core/bitstreams/2a070ce5-1d88-4866-8e96-db7779c8782a/content](https://upcommons.upc.edu/server/api/core/bitstreams/2a070ce5-1d88-4866-8e96-db7779c8782a/content)  
12. Construction of Arbitrary Order Finite Element Degree-of-Freedom Maps on Polygonal and Polyhedral Cell Meshes = mscroggs.co.uk, accessed November 25, 2025, [https://www.mscroggs.co.uk/papers/2022-dofs.pdf](https://www.mscroggs.co.uk/papers/2022-dofs.pdf)  
13. POTENTIAL FORMULATIONS IN MAGNETICS APPLYING THE FINITE ELEMENT METHOD Lecture notes = Mikrocontroller.net, accessed November 25, 2025, [https://www.mikrocontroller.net/attachment/642256/magnetic.pdf](https://www.mikrocontroller.net/attachment/642256/magnetic.pdf)  
14. Methods to Compute Magnetic Flux Linkages Along H-Based Finite Element Formulations = IEEE Xplore, accessed November 25, 2025, [https://ieeexplore.ieee.org/iel8/20/11142835/11069308.pdf](https://ieeexplore.ieee.org/iel8/20/11142835/11069308.pdf)  
15. An Analytical Calculation of the Magnetic Field Using the Biot Savart Law = ResearchGate, accessed November 25, 2025, [https://www.researchgate.net/publication/26361186_An_Analytical_Calculation_of_the_Magnetic_Field_Using_the_Biot_Savart_Law](https://www.researchgate.net/publication/26361186_An_Analytical_Calculation_of_the_Magnetic_Field_Using_the_Biot_Savart_Law)  
16. \[2002.09444\] A Novel Exact Analytical Expression for the Magnetic Field of a Solenoid, accessed November 25, 2025, [https://arxiv.org/abs/2002.09444](https://arxiv.org/abs/2002.09444)  
17. Schematic view of the race track-coil wire turns for calculations of the magnetic field distribution originating from the semicircular ends of the coil turn. = ResearchGate, accessed November 25, 2025, [https://www.researchgate.net/figure/Schematic-view-of-the-race-track-coil-wire-turns-for-calculations-of-the-magnetic-field_fig3_270269324](https://www.researchgate.net/figure/Schematic-view-of-the-race-track-coil-wire-turns-for-calculations-of-the-magnetic-field_fig3_270269324)  
18. A Finite-Difference Formulation of the Magnetic Vector Potential = DTIC, accessed November 25, 2025, [https://apps.dtic.mil/sti/tr/pdf/ADA070495.pdf](https://apps.dtic.mil/sti/tr/pdf/ADA070495.pdf)  
19. Biot Savart magnetic Toolbox = File Exchange = MATLAB Central = MathWorks, accessed November 25, 2025, [https://www.mathworks.com/matlabcentral/fileexchange/50434-biot-savart-magnetic-toolbox](https://www.mathworks.com/matlabcentral/fileexchange/50434-biot-savart-magnetic-toolbox)  
20. Biot-Savart Law: MATLAB Analysis | PDF | Applied And Interdisciplinary Physics = Scribd, accessed November 25, 2025, [https://www.scribd.com/document/687932392/K23-CC12-Gr08-Project2](https://www.scribd.com/document/687932392/K23-CC12-Gr08-Project2)  
21. 14.10. Newton-Raphson Procedure = Ansys Help website, accessed November 25, 2025, [https://ansyshelp.ansys.com/public/Views/Secured/corp/v252/en/ans_thry/thy_tool10.html](https://ansyshelp.ansys.com/public/Views/Secured/corp/v252/en/ans_thry/thy_tool10.html)  
22. The Harmonic Balance method for the solution of nonlinear circuit and field problems with harmonic sources and its integration with a commercial simulation software, accessed November 25, 2025, [https://thesis.unipd.it/retrieve/2b82a529-633a-4f25-8e4a-ea9fcd226a5a/Giust_Alessandro_tesi.pdf](https://thesis.unipd.it/retrieve/2b82a529-633a-4f25-8e4a-ea9fcd226a5a/Giust_Alessandro_tesi.pdf)  
23. Implementation of the harmonic balance FEM method for large-scale saturated electromagnetic devices = SciSpace, accessed November 25, 2025, [https://scispace.com/pdf/implementation-of-the-harmonic-balance-fem-method-for-large-29r9baujyw.pdf](https://scispace.com/pdf/implementation-of-the-harmonic-balance-fem-method-for-large-29r9baujyw.pdf)  
24. arXiv:2503.19657v1 \[physics.acc-ph\] 25 Mar 2025, accessed November 25, 2025, [https://arxiv.org/pdf/2503.19657](https://arxiv.org/pdf/2503.19657)  
25. Harmonic Balance Finite Element Method applied for Nonlinear Lamination stack with short circuits = ResearchGate, accessed November 25, 2025, [https://www.researchgate.net/publication/314385154_Harmonic_Balance_Finite_Element_Method_applied_for_Nonlinear_Lamination_stack_with_short_circuits](https://www.researchgate.net/publication/314385154_Harmonic_Balance_Finite_Element_Method_applied_for_Nonlinear_Lamination_stack_with_short_circuits)  
26. PARFOR progress monitor (progress bar) v4 = File Exchange = MATLAB Central, accessed November 25, 2025, [https://www.mathworks.com/matlabcentral/fileexchange/71436-parfor-progress-monitor-progress-bar-v4](https://www.mathworks.com/matlabcentral/fileexchange/71436-parfor-progress-monitor-progress-bar-v4)  
27. How to Add a Progress Bar for Matlab parfor Loops | Vladislav Morozov, PhD, accessed November 25, 2025, [https://vladislav-morozov.github.io/blog/simulations/tools/2024-11-11-simple-parfor-progress-bar/](https://vladislav-morozov.github.io/blog/simulations/tools/2024-11-11-simple-parfor-progress-bar/)  
28. pointLocation = (Not recommended) Triangle or tetrahedron enclosing point = MATLAB, accessed November 25, 2025, [https://www.mathworks.com/help/matlab/ref/delaunaytri.pointlocation.html](https://www.mathworks.com/help/matlab/ref/delaunaytri.pointlocation.html)  
29. Point location in tetrahedron meshes = Stack Overflow, accessed November 25, 2025, [https://stackoverflow.com/questions/11849435/point-location-in-tetrahedron-meshes](https://stackoverflow.com/questions/11849435/point-location-in-tetrahedron-meshes)